var app=angular.module("WebApp",["ng","ngResource"]);

app.controller("ListCtrl",["$scope","$rootScope","$http",function(o,e,n){var c=[];o.model=!1,o.search="",o.feed=[];var a=function(e,c){o.model=e,n.get("/api/"+e).success(function(e){"InternalError"!=e.code&&(o.feed=e,c&&c())}).error(function(o){console.log(o)})},t=function(e){for(var n in o.feed)if(o.feed[n]._id==e){o.edit=o.feed[n];break}if(!o.edit){var c="/"+o.model+"/new";location.pathname!==c&&(location.pathname=c)}};o.update=function(){n.put("/api/"+o.model+"/"+o.id,o.edit).success(function(e){console.log(e),o.alert="Message: "+o.model+" updated"}).error(function(o){console.log(o)})},o.create=function(e){n.post("/api/"+o.model,e).success(function(e){console.log(e),o.alert="Message: "+o.model+" created"}).error(function(o){console.log(o)})};var l=function(){var o="";for(var e in c)o=o+"#"+c[e],c.length-1!=e&&(o+="|");var n=location.hash.match(new RegExp("(W|^)("+o+")(W|$)"));return n?n[0]:!1};o.setHashId=function(o){console.log(o),location.hash=location.hash+"/"+o._id},e.$on("load:resources",function(o,n){c=n,console.log("load:resources");var t=l();t&&(console.log("hash:"+t),t=l().replace("#",""),a(t),e.$emit("load:param",t))}),e.$on("change:model",function(o,e){a(e),location.hash=e,console.log("change:model")}),e.$on("watch:search",function(e,n){o.search=n,console.log("watch:search")}),o.$watch("model",function(e){a(e,function(){t(o.id)}),console.log("watch:model")})}]);
app.controller("NavBarCtrl",["$scope","$rootScope","$http",function(e,o,r){e.search="",e.themes=[],e.resources=[];var t=function(){var e="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css",o=window.localStorage.getItem("theme");return null===o?e:o},c=function(){var e=window.localStorage.getItem("resource");return null===e?!1:e};e.setTheme=function(o){e.theme=o.css,localStorage.setItem("theme",o.css)},e.setResource=function(r){e.resource=r,o.$emit("change:model",r)},o.$on("load:param",function(o,r){e.resource=r,console.log("load:param")}),e.$watch("search",function(e){o.$emit("watch:search",e)}),e.theme=t(),e.resource=c(),r.get("/properties.json").success(function(r){"InternalError"!=r.code&&(e.resources=r.resources,e.themes=r.themes,o.$emit("load:resources",r.resources||[]))}).error(function(e){console.log(e)})}]);